<h1>About</h1>
<p>設計一甲</p>
<p>40823103</p>
<p>呂霈瑜<img alt="" src="/images/index.html"/></p>
<h1>Develop</h1>
<p><a href="https://github.com/mdecourse/cmsimde">https://github.com/mdecourse/cmsimde</a> 的開發, 可以在一個目錄中放入 cmsimde, 然後將 up_dir 中的內容放到與 cmsimde 目錄同位階的地方, 使用 command 進入 cmsimde 目錄, 執行 python wsgi.py, 就可以啟動, 以瀏覽器 https://localhost:9443 就可以連接, 以 admin 作為管理者密碼, 就可以登入維護內容.</p>
<p>cmsimde 的開發採用 Leo Editor, 開啟 cmsimde 目錄中的 cmsimde.leo 就可以進行程式修改, 結束後, 若要保留網際內容, 只要將 cmsimde 外部的內容倒回 up_dir 目錄中即可後續對 cmsimde 遠端倉儲進行改版.</p>
<p>init.py 位於  up_dir 目錄, 可以設定 site_title 與 uwsgi 等變數.</p>
<p>we have </p>
<h1>Grouping</h1>
<p>1a</p>
<p>wcmg1 組長: 40823131<br/>40823126<br/>40823123<br/>40823124<br/>40823128</p>
<p>wcmg2 組長: 40823112<br/>40823108<br/>40823109<br/>40823111<br/>40823145</p>
<p>wcmg3 組長: 40823125<br/>40823129<br/>40823137<br/>40823136<br/>40823151</p>
<p>wcmg4 組長: 40823110<br/>40823103<br/>40823107<br/>40823130<br/>40823142</p>
<p><span>wcmg5 組長: 40823143</span><br/>40823144<br/>40543118<br/>40823127</p>
<h1>每周進度</h1>
<p></p>
<p>import csv # read student list filename = 'E:/wcm2020/data/tmp/2020_spring_score/2a/2a_list.txt' with open(filename, encoding="utf-8") as f: content = f.readlines() #print(content) student = [x.strip() for x in content] #print(student) # Timestamp, email, 修課名稱, url, score, desp, memo # 0, 1, 2, 3, 4, 5, 6 #total = 0 all = {} with open('y:/2020midterm.csv', encoding="utf-8") as csv_file: csv_reader = csv.reader(csv_file, delimiter=',') #print(csv_reader) line_count = 0 for row in csv_reader: if line_count == 0: #print(f'Column names are {", ".join(row)}') line_count += 1 else: student_num = row[1].split("@")[0] #print(student_num) student_score = row[4] #print(student_score) try: all.update({student_num: student_score}) except: all.update({student_num: "error"}) #print(f'\t{row[0]} works in the {row[1]} department, and was born in {row[2]}.') #print(f'\t{row[4]}') #total += int(row[4]) line_count += 1 #print(all) #print(student) for i in student: #if i in all: #pass #else: #print(str(i)) try: print(i + "\t" + all[i]) except: print(i + "\t60") #print(f'Processed {line_count} lines.') #print("平均=" + str(total/line_count))</p><h2>W10-W11</h2>
<p><span>利用 Python 程式讀取同學修課檔案, 以及從 Google Sheet 轉出的 .csv, 分別處理為 List 與 Dictionary 資料格式之後, 逐一根據同學 List 學號, 從 Dictionary 取出自評成績.</span></p>
<div class="line number1 index0 alt2"><code class="dart keyword">import</code> <code class="dart plain">csv</code></div>
<div class="line number2 index1 alt1"><code class="dart spaces"> </code> </div>
<div class="line number3 index2 alt2"><code class="dart preprocessor"># read student list</code></div>
<div class="line number4 index3 alt1"><code class="dart spaces"> </code> </div>
<div class="line number5 index4 alt2"><code class="dart plain">filename = </code><code class="dart string">'E:/wcm2020/data/tmp/2020_spring_score/2a/2a_list.txt'</code></div>
<div class="line number6 index5 alt1"><code class="dart keyword">with</code> <code class="dart plain">open(filename, encoding=</code><code class="dart string">"utf-8"</code><code class="dart plain">) </code><code class="dart keyword">as</code> <code class="dart plain">f:</code></div>
<div class="line number7 index6 alt2"><code class="dart spaces">    </code><code class="dart plain">content = f.readlines()</code></div>
<div class="line number8 index7 alt1"><code class="dart preprocessor">#print(content)</code></div>
<div class="line number9 index8 alt2"><code class="dart plain">student = [x.strip() </code><code class="dart keyword">for</code> <code class="dart plain">x </code><code class="dart keyword">in</code> <code class="dart plain">content]</code></div>
<div class="line number10 index9 alt1"><code class="dart preprocessor">#print(student)</code></div>
<div class="line number11 index10 alt2"><code class="dart spaces"> </code> </div>
<div class="line number12 index11 alt1"><code class="dart spaces"> </code> </div>
<div class="line number13 index12 alt2"><code class="dart preprocessor"># Timestamp, email, 修課名稱, url, score, desp, memo</code></div>
<div class="line number14 index13 alt1"><code class="dart preprocessor"># 0, 1, 2, 3, 4, 5, 6</code></div>
<div class="line number15 index14 alt2"><code class="dart preprocessor">#total = 0</code></div>
<div class="line number16 index15 alt1"><code class="dart plain">all = {}</code></div>
<div class="line number17 index16 alt2"><code class="dart keyword">with</code> <code class="dart plain">open(</code><code class="dart string">'y:/2020midterm.csv'</code><code class="dart plain">, encoding=</code><code class="dart string">"utf-8"</code><code class="dart plain">) </code><code class="dart keyword">as</code> <code class="dart plain">csv_file:</code></div>
<div class="line number18 index17 alt1"><code class="dart spaces">    </code><code class="dart plain">csv_reader = csv.reader(csv_file, delimiter=</code><code class="dart string">','</code><code class="dart plain">)</code></div>
<div class="line number19 index18 alt2"><code class="dart spaces">    </code><code class="dart preprocessor">#print(csv_reader)</code></div>
<div class="line number20 index19 alt1"><code class="dart spaces"> </code> </div>
<div class="line number21 index20 alt2"><code class="dart spaces">    </code><code class="dart plain">line_count = 0</code></div>
<div class="line number22 index21 alt1"><code class="dart spaces">    </code><code class="dart keyword">for</code> <code class="dart plain">row </code><code class="dart keyword">in</code> <code class="dart plain">csv_reader:</code></div>
<div class="line number23 index22 alt2"><code class="dart spaces">        </code><code class="dart keyword">if</code> <code class="dart plain">line_count == 0:</code></div>
<div class="line number24 index23 alt1"><code class="dart spaces">            </code><code class="dart preprocessor">#print(f'Column names are {", ".join(row)}')</code></div>
<div class="line number25 index24 alt2"><code class="dart spaces">            </code><code class="dart plain">line_count += 1</code></div>
<div class="line number26 index25 alt1"><code class="dart spaces">        </code><code class="dart keyword">else</code><code class="dart plain">:</code></div>
<div class="line number27 index26 alt2"><code class="dart spaces">            </code><code class="dart plain">student_num = row[1].split(</code><code class="dart string">"@"</code><code class="dart plain">)[0]</code></div>
<div class="line number28 index27 alt1"><code class="dart spaces">            </code><code class="dart preprocessor">#print(student_num)</code></div>
<div class="line number29 index28 alt2"><code class="dart spaces">            </code><code class="dart plain">student_score = row[4]</code></div>
<div class="line number30 index29 alt1"><code class="dart spaces">            </code><code class="dart preprocessor">#print(student_score)</code></div>
<div class="line number31 index30 alt2"><code class="dart spaces">            </code><code class="dart keyword">try</code><code class="dart plain">:</code></div>
<div class="line number32 index31 alt1"><code class="dart spaces">                </code><code class="dart plain">all.update({student_num: student_score})</code></div>
<div class="line number33 index32 alt2"><code class="dart spaces">            </code><code class="dart plain">except:</code></div>
<div class="line number34 index33 alt1"><code class="dart spaces">                </code><code class="dart plain">all.update({student_num: </code><code class="dart string">"error"</code><code class="dart plain">})</code></div>
<div class="line number35 index34 alt2"><code class="dart spaces">            </code><code class="dart preprocessor">#print(f'\t{row[0]} works in the {row[1]} department, and was born in {row[2]}.')</code></div>
<div class="line number36 index35 alt1"><code class="dart spaces">            </code><code class="dart preprocessor">#print(f'\t{row[4]}')</code></div>
<div class="line number37 index36 alt2"><code class="dart spaces">            </code><code class="dart preprocessor">#total += int(row[4])</code></div>
<div class="line number38 index37 alt1"><code class="dart spaces">            </code><code class="dart plain">line_count += 1</code></div>
<div class="line number39 index38 alt2"><code class="dart preprocessor">#print(all)</code></div>
<div class="line number40 index39 alt1"><code class="dart preprocessor">#print(student)</code></div>
<div class="line number41 index40 alt2"><code class="dart spaces"> </code> </div>
<div class="line number42 index41 alt1"><code class="dart spaces"> </code> </div>
<div class="line number43 index42 alt2"><code class="dart keyword">for</code> <code class="dart plain">i </code><code class="dart keyword">in</code> <code class="dart plain">student:</code></div>
<div class="line number44 index43 alt1"><code class="dart spaces">     </code> </div>
<div class="line number45 index44 alt2"><code class="dart spaces">    </code><code class="dart preprocessor">#if i in all:</code></div>
<div class="line number46 index45 alt1"><code class="dart spaces">        </code><code class="dart preprocessor">#pass</code></div>
<div class="line number47 index46 alt2"><code class="dart spaces">    </code><code class="dart preprocessor">#else:</code></div>
<div class="line number48 index47 alt1"><code class="dart spaces">        </code><code class="dart preprocessor">#print(str(i))</code></div>
<div class="line number49 index48 alt2"><code class="dart spaces">     </code> </div>
<div class="line number50 index49 alt1"><code class="dart spaces">    </code><code class="dart keyword">try</code><code class="dart plain">:</code></div>
<div class="line number51 index50 alt2"><code class="dart spaces">        </code><code class="dart plain">print(i + </code><code class="dart string">"\t"</code> <code class="dart plain">+ all[i])</code></div>
<div class="line number52 index51 alt1"><code class="dart spaces">    </code><code class="dart plain">except:</code></div>
<div class="line number53 index52 alt2"><code class="dart spaces">        </code><code class="dart plain">print(i + </code><code class="dart string">"\t60"</code><code class="dart plain">)</code></div>
<div class="line number54 index53 alt1"><code class="dart spaces"> </code> </div>
<div class="line number55 index54 alt2"><code class="dart spaces">    </code><code class="dart preprocessor">#print(f'Processed {line_count} lines.')</code></div>
<div class="line number56 index55 alt1"><code class="dart spaces">    </code><code class="dart preprocessor">#print("平均=" + str(total/line_count))</code></div>